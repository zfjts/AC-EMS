{% extends "base.html" %}

{% block content %}
<div class="container mx-auto px-4 py-8">
    <div class="flex justify-between items-center mb-6">
    <h1 class="text-2xl font-bold text-gray-800">库存交易管理</h1>
    <div class="space-x-4">
        <a href="/inventory/transactions/create/?type=入库" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-md transition duration-300 shadow-sm">
            <i class="fa fa-plus mr-2"></i>入库操作
        </a>
        <a href="/inventory/transactions/create/?type=出库" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md transition duration-300 shadow-sm">
            <i class="fa fa-minus mr-2"></i>出库操作
        </a>
        <a href="/inventory/transactions/create/?type=移库" class="bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-md transition duration-300 shadow-sm">
            <i class="fa fa-exchange mr-2"></i>移库操作
        </a>
    </div>
</div>

    <div class="bg-white rounded-lg shadow-md overflow-hidden card-hover">
        <table class="min-w-full divide-y divide-gray-200">
            <thead class="bg-gray-50">
                <tr>
                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">交易编号</th>
                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">备件名称</th>
                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">交易类型</th>
                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">数量</th>
                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">库位</th>
                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">订单号</th>
                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">状态</th>
                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">操作员</th>
                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">操作时间</th>
                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">操作</th>
                </tr>
            </thead>
            <tbody class="bg-white divide-y divide-gray-200">
                {% for transaction in transactions %}
                <tr>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">{{ transaction.id }}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{{ transaction.spare_part.name }}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                        {% if transaction.transaction_type == '入库' %}
                            <span class="px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800">{{ transaction.transaction_type }}</span>
                        {% elif transaction.transaction_type == '出库' %}
                            <span class="px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800">{{ transaction.transaction_type }}</span>
                        {% else %}
                            <span class="px-2 py-1 text-xs font-semibold rounded-full bg-yellow-100 text-yellow-800">{{ transaction.transaction_type }}</span>
                        {% endif %}
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{{ transaction.quantity }}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                        {% if transaction.from_location %}{{ transaction.from_location.name }} → {% endif %}
                        {% if transaction.to_location %}{{ transaction.to_location.name }}{% endif %}
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{{ transaction.order_number or '-' }}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{{ transaction.status }}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{{ transaction.operator or '-' }}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{{ transaction.created_at.strftime('%Y-%m-%d %H:%M:%S') }}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                        <a href="/inventory/transactions/edit/{{ transaction.id }}" class="text-primary hover:text-primary/80 mr-4">编辑</a>
                        {% if transaction.status == '保存' %}
                        <a href="/inventory/transactions/submit/{{ transaction.id }}" class="text-green-600 hover:text-green-800 mr-4">提交</a>
                        {% endif %}
                        <a href="/inventory/transactions/delete/{{ transaction.id }}" class="text-red-600 hover:text-red-800" onclick="return confirm('确定要删除这笔交易吗？')">删除</a>
                    </td>
                </tr>
                {% else %}
                <tr>
                    <td colspan="10" class="px-6 py-12 text-center">
                        <div class="flex flex-col items-center justify-center">
                            <i class="fa fa-exchange text-4xl text-gray-300 mb-4"></i>
                            <p class="text-gray-500 mb-6">没有找到交易记录</p>

                        </div>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}